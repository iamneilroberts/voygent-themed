<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voygent - AI-Powered Travel Planning</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f8f9fa;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px 20px;
      text-align: center;
      margin-bottom: 30px;
    }
    h1 { font-size: 2.5rem; margin-bottom: 10px; }
    .subtitle { opacity: 0.9; font-size: 1.1rem; }

    .quick-tuner {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .quick-tuner h2 { margin-bottom: 20px; color: #667eea; }
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
    }
    .form-group {
      display: flex;
      flex-direction: column;
    }
    label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #555;
    }
    input, select, textarea {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
      font-family: inherit;
    }
    textarea { min-height: 100px; resize: vertical; }

    .upload-section {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .upload-section h2 { margin-bottom: 20px; color: #764ba2; }
    .upload-area {
      border: 2px dashed #ccc;
      border-radius: 8px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }
    .upload-area:hover { border-color: #667eea; background: #f0f4ff; }
    .upload-area.dragover { border-color: #764ba2; background: #f5e6ff; }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 32px;
      font-size: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.2s;
    }
    button:hover { transform: translateY(-2px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    @media (max-width: 768px) {
      .options-grid {
        grid-template-columns: 1fr;
      }
    }
    .option-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.3s;
      border: 3px solid transparent;
    }
    .option-card:hover { transform: translateY(-4px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    .option-card.selected { border-color: #667eea; }
    .option-card h3 { color: #667eea; margin-bottom: 10px; font-size: 1.2rem; }
    .option-card .why {
      color: #666;
      font-style: italic;
      margin-bottom: 15px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }
    .option-card .days { font-size: 0.9rem; color: #777; }

    .variants-section {
      margin-top: 30px;
    }
    .variant-card {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .variant-card h3 { color: #764ba2; margin-bottom: 15px; }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
      font-size: 1.2rem;
    }
    .error {
      background: #fee;
      border: 1px solid #fcc;
      padding: 15px;
      border-radius: 8px;
      color: #c33;
      margin: 20px 0;
    }
    .success {
      background: #efe;
      border: 1px solid #cfc;
      padding: 15px;
      border-radius: 8px;
      color: #363;
      margin: 20px 0;
    }

    .hidden { display: none; }

    /* Chat Interface */
    .chat-section {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 30px;
      max-height: 500px;
      display: flex;
      flex-direction: column;
    }
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 15px;
      padding: 10px;
      border: 1px solid #eee;
      border-radius: 8px;
    }
    .chat-message {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 8px;
      max-width: 80%;
    }
    .chat-message.user {
      background: #667eea;
      color: white;
      margin-left: auto;
    }
    .chat-message.assistant {
      background: #f0f0f0;
      color: #333;
    }
    .chat-input-area {
      display: flex;
      gap: 10px;
    }
    .chat-input-area input {
      flex: 1;
    }
    .chat-input-area button {
      padding: 10px 20px;
    }

    /* Diagnostics */
    .diagnostics {
      background: #1a1a1a;
      color: #0f0;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      max-height: 400px;
      overflow-y: auto;
    }
    .diagnostics h3 {
      color: #0f0;
      margin-bottom: 10px;
    }
    .diagnostics .log-entry {
      margin-bottom: 10px;
      padding: 8px;
      background: #2a2a2a;
      border-radius: 4px;
    }
    .diagnostics .timestamp {
      color: #888;
      font-size: 0.8rem;
    }
    .diagnostics .provider {
      color: #4a9eff;
    }
    .diagnostics .tokens {
      color: #ffa500;
    }
    .diagnostics .cost {
      color: #ff4444;
    }
    .toggle-diagnostics {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #1a1a1a;
      color: #0f0;
      border: 2px solid #0f0;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-family: 'Courier New', monospace;
      z-index: 1000;
    }
    .toggle-diagnostics:hover {
      background: #0f0;
      color: #1a1a1a;
    }

    .variant-card button {
      margin-top: 15px;
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    /* Collapsible form styles */
    .form-collapsible-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    .form-collapsible-header h2 {
      margin-bottom: 0;
    }
    .collapse-toggle {
      font-size: 1.5rem;
      transition: transform 0.3s ease;
    }
    .collapse-toggle.collapsed {
      transform: rotate(-90deg);
    }
    .form-content {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.4s ease, opacity 0.3s ease;
      opacity: 1;
    }
    .form-content.collapsed {
      max-height: 0;
      opacity: 0;
    }

    /* Progress steps */
    .progress-step {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      margin: 10px 0;
      background: white;
      border-radius: 8px;
      border-left: 4px solid #667eea;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      animation: slideIn 0.3s ease;
    }
    .progress-step .step-icon {
      font-size: 1.5rem;
    }
    .progress-step .step-text {
      font-size: 1.1rem;
      color: #333;
      font-weight: 500;
    }
    .progress-step.completed {
      border-left-color: #10b981;
      background: linear-gradient(90deg, #f0fdf4 0%, white 100%);
    }
    .progress-step.completed .step-icon::after {
      content: ' ‚úì';
      color: #10b981;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üåç Voygent</h1>
    <p class="subtitle">AI-Powered Travel Planning for Your Perfect Journey</p>
  </header>

  <div class="container">
    <!-- Trip Theme Selector -->
    <div class="quick-tuner" style="text-align: center; padding: 30px;">
      <h2 style="font-size: 1.8rem; margin-bottom: 20px;">Choose Your Trip Theme</h2>
      <div id="themeSelector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; max-width: 1000px; margin: 0 auto;">
        <div class="theme-card" data-theme="heritage" style="cursor: pointer; padding: 20px; background: white; border: 3px solid transparent; border-radius: 12px; transition: all 0.3s;">
          <div style="font-size: 3rem; margin-bottom: 10px;">üå≥</div>
          <h3 style="margin: 0 0 8px 0; color: #667eea;">Heritage & Ancestry</h3>
          <p style="font-size: 0.9rem; color: #666; margin: 0;">Explore your family roots</p>
        </div>
        <div class="theme-card" data-theme="tvmovie" style="cursor: pointer; padding: 20px; background: white; border: 3px solid transparent; border-radius: 12px; transition: all 0.3s;">
          <div style="font-size: 3rem; margin-bottom: 10px;">üé¨</div>
          <h3 style="margin: 0 0 8px 0; color: #667eea;">TV & Movie Locations</h3>
          <p style="font-size: 0.9rem; color: #666; margin: 0;">Visit filming locations</p>
        </div>
        <div class="theme-card" data-theme="historical" style="cursor: pointer; padding: 20px; background: white; border: 3px solid transparent; border-radius: 12px; transition: all 0.3s;">
          <div style="font-size: 3rem; margin-bottom: 10px;">‚öîÔ∏è</div>
          <h3 style="margin: 0 0 8px 0; color: #667eea;">Historical Events</h3>
          <p style="font-size: 0.9rem; color: #666; margin: 0;">Walk through history</p>
        </div>
        <div class="theme-card" data-theme="culinary" style="cursor: pointer; padding: 20px; background: white; border: 3px solid transparent; border-radius: 12px; transition: all 0.3s;">
          <div style="font-size: 3rem; margin-bottom: 10px;">üç¥</div>
          <h3 style="margin: 0 0 8px 0; color: #667eea;">Culinary Tours</h3>
          <p style="font-size: 0.9rem; color: #666; margin: 0;">Explore regional cuisines</p>
        </div>
        <div class="theme-card" data-theme="adventure" style="cursor: pointer; padding: 20px; background: white; border: 3px solid transparent; border-radius: 12px; transition: all 0.3s;">
          <div style="font-size: 3rem; margin-bottom: 10px;">üèîÔ∏è</div>
          <h3 style="margin: 0 0 8px 0; color: #667eea;">Adventure & Outdoor</h3>
          <p style="font-size: 0.9rem; color: #666; margin: 0;">Hiking, wildlife, nature</p>
        </div>
      </div>
      <input type="hidden" id="selectedTheme" value="heritage">
    </div>

    <!-- Hero Quick Start -->
    <div class="quick-tuner" style="text-align: center; padding: 40px 30px;">
      <h2 style="font-size: 2rem; margin-bottom: 15px;">‚ú® <span id="heroTitle">Follow Your Family Roots</span></h2>
      <p id="heroSubtitle" style="color: #666; margin-bottom: 25px; font-size: 1.1rem;">Enter your surname and we'll create a personalized heritage trip in seconds</p>
      <div style="display: flex; gap: 12px; max-width: 500px; margin: 0 auto; flex-wrap: wrap; justify-content: center;">
        <input type="text" id="quickStartInput" placeholder="Enter your surname (e.g., McElroy)"
               style="flex: 1; min-width: 200px; padding: 14px; font-size: 1.1rem; border: 2px solid #764ba2;">
        <button type="button" id="quickStartBtn" style="padding: 14px 28px; font-size: 1.1rem; white-space: nowrap;">
          üöÄ Create My Trip
        </button>
      </div>
      <p style="margin-top: 15px; font-size: 0.9rem; color: #888;">Or customize details below ‚Üì</p>
    </div>

    <!-- Quick Tuner Section -->
    <div class="quick-tuner" id="customizeSection">
      <div class="form-collapsible-header" id="formCollapseHeader">
        <h2>üìù Customize Your Trip</h2>
        <span class="collapse-toggle collapsed">‚ñº</span>
      </div>
      <form id="quickTunerForm" class="form-content collapsed" style="margin-top: 20px;">
        <div class="form-grid">
          <div class="form-group" id="themeSpecificField1">
            <label for="surnames" id="field1Label">Family Surnames *</label>
            <input type="text" id="surnames" placeholder="e.g., McLeod, Roberts">
          </div>
          <div class="form-group" id="themeSpecificField2">
            <label for="origins" id="field2Label">Suspected Origins</label>
            <input type="text" id="origins" placeholder="Unknown - AI will guess from surname">
          </div>
          <div class="form-group">
            <label for="adults">Adults</label>
            <input type="number" id="adults" min="1" value="2" required>
          </div>
          <div class="form-group">
            <label for="children">Children (ages)</label>
            <input type="text" id="children" placeholder="e.g., 12, 15">
          </div>
          <div class="form-group">
            <label for="duration">Duration (days)</label>
            <input type="number" id="duration" min="1" max="30" value="7">
          </div>
          <div class="form-group">
            <label for="month">Target Month</label>
            <select id="month">
              <option value="">Any</option>
              <option value="January">January</option>
              <option value="February">February</option>
              <option value="March">March</option>
              <option value="April">April</option>
              <option value="May">May</option>
              <option value="June">June</option>
              <option value="July">July</option>
              <option value="August">August</option>
              <option value="September">September</option>
              <option value="October">October</option>
              <option value="November">November</option>
              <option value="December">December</option>
            </select>
          </div>
          <div class="form-group">
            <label for="luxury">Luxury Level</label>
            <select id="luxury">
              <option value="Savvy">Savvy</option>
              <option value="Comfort" selected>Comfort</option>
              <option value="Boutique">Boutique</option>
              <option value="OccasionalLuxe">Occasional Luxe</option>
            </select>
          </div>
          <div class="form-group">
            <label for="activity">Activity Level</label>
            <select id="activity">
              <option value="gentle">Gentle</option>
              <option value="moderate" selected>Moderate</option>
              <option value="ambitious">Ambitious</option>
            </select>
          </div>
          <div class="form-group">
            <label for="travel_pace">Travel Pace</label>
            <select id="travel_pace">
              <option value="relaxed">Relaxed (2-3 days per city)</option>
              <option value="moderate" selected>Moderate (2 cities per 10 days)</option>
              <option value="exploratory">Exploratory (3-4 cities per 10 days)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="airport">Departure Airport</label>
            <input type="text" id="airport" placeholder="e.g., LAX, JFK, ORD">
          </div>
          <div class="form-group">
            <label for="transport_pref">Transport Preference</label>
            <select id="transport_pref">
              <option value="train">Train preferred</option>
              <option value="car">Car rental preferred</option>
              <option value="mixed" selected>Mix of train & car</option>
              <option value="driver">Driver/guide preferred</option>
            </select>
          </div>
          <div class="form-group">
            <label for="hotel_type">Hotel Type</label>
            <select id="hotel_type">
              <option value="budget">Budget ($80-120/night)</option>
              <option value="midrange" selected>Mid-range ($120-200/night)</option>
              <option value="upscale">Upscale ($200-350/night)</option>
              <option value="luxury">Luxury ($350+/night)</option>
            </select>
          </div>
        </div>
        <div class="form-group" style="margin-top: 20px;">
          <label for="notes">Additional Notes / Genealogy Links</label>
          <textarea id="notes" placeholder="Paste genealogy URLs, add context about your family history..."></textarea>
        </div>
      </form>
    </div>

    <!-- Upload Section -->
    <div class="upload-section" id="uploadSection">
      <div class="form-collapsible-header" id="uploadCollapseHeader">
        <h2>üìé Upload Documents</h2>
        <span class="collapse-toggle collapsed">‚ñº</span>
      </div>
      <div class="form-content collapsed" id="uploadContent" style="margin-top: 20px;">
        <div class="upload-area" id="uploadArea">
        <p>üìÅ Drop files here or click to upload</p>
        <p style="font-size: 0.9rem; color: #999; margin-top: 10px;">
          PDFs, images (OCR supported), or text documents
        </p>
        <input type="file" id="fileInput" multiple accept="image/*,.pdf,.txt" style="display:none;">
      </div>
      <div id="fileList" style="margin-top: 15px;"></div>
      </div>
    </div>

    <button id="generateBtn" onclick="generateTrip()">‚ú® Generate Trip Options</button>

    <div id="loading" class="loading hidden">
      <div style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 3rem; animation: spin 2s linear infinite; display: inline-block;">üîÑ</div>
      </div>
      <div id="progressSteps" style="max-width: 600px; margin: 0 auto;">
        <div class="progress-step" id="step1">
          <span class="step-icon">‚è≥</span>
          <span class="step-text">Analyzing your input...</span>
        </div>
        <div class="progress-step hidden" id="step2">
          <span class="step-icon">üîç</span>
          <span class="step-text">Researching surname origins...</span>
        </div>
        <div class="progress-step hidden" id="step3">
          <span class="step-icon">üß†</span>
          <span class="step-text">AI analyzing heritage connections...</span>
        </div>
        <div class="progress-step hidden" id="step4">
          <span class="step-icon">‚úàÔ∏è</span>
          <span class="step-text">Generating personalized trip options...</span>
        </div>
      </div>

      <!-- Detailed progress log -->
      <details open style="max-width: 800px; margin: 30px auto 0; background: white; padding: 20px; border-radius: 8px;">
        <summary style="cursor: pointer; font-weight: 600; color: #667eea; margin-bottom: 15px;">üìã Detailed Progress Log</summary>
        <div id="progressLog" style="font-family: 'Courier New', monospace; font-size: 0.85rem; max-height: 300px; overflow-y: auto; background: #1a1a1a; color: #0f0; padding: 15px; border-radius: 4px;">
          <div class="log-line">‚è≥ Initializing...</div>
        </div>
      </details>
    </div>

    <div id="error" class="error hidden"></div>
    <div id="success" class="success hidden"></div>

    <!-- AI Research Summary -->
    <div id="researchSummary" class="hidden" style="background: linear-gradient(135deg, #e8f4f8 0%, #f0e8ff 100%); padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 5px solid #667eea;">
      <h2 style="color: #667eea; margin-bottom: 15px;">üîç What We Discovered About Your Heritage</h2>
      <div id="researchContent" style="font-size: 1.05rem; line-height: 1.8; color: #333;"></div>
      <details style="margin-top: 20px;">
        <summary style="cursor: pointer; color: #667eea; font-weight: 600;">üìö View Research Sources</summary>
        <div id="researchSources" style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.6); border-radius: 8px;"></div>
      </details>
    </div>

    <!-- Options Grid -->
    <div id="optionsSection" class="hidden">
      <h2 style="margin-top: 40px; margin-bottom: 20px;">Choose Your Journey</h2>
      <div id="optionsGrid" class="options-grid"></div>
      <button id="confirmBtn" class="hidden" onclick="confirmSelection()" style="margin-top: 20px;">
        Continue to Detailed Itineraries
      </button>
    </div>

    <!-- Trip Styles -->
    <div id="variantsSection" class="variants-section hidden">
      <h2>Choose Your Trip Style</h2>
      <p style="color: #666; margin-bottom: 20px;">We've created two different styles for your trip. Review both and select your preference.</p>
      <div id="variantsContainer"></div>
    </div>

    <!-- Chat Interface -->
    <div id="chatSection" class="chat-section hidden">
      <h3>üí¨ Chat with Voygent</h3>
      <div id="chatMessages" class="chat-messages"></div>
      <div class="chat-input-area">
        <input type="text" id="chatInput" placeholder="Ask about your trip, make changes..." />
        <button onclick="sendChatMessage()">Send</button>
      </div>
    </div>

    <!-- Diagnostics -->
    <div id="diagnostics" class="diagnostics hidden">
      <h3>üîß Developer Diagnostics</h3>
      <div id="diagnosticsLog"></div>
    </div>
  </div>

  <button class="toggle-diagnostics" onclick="toggleDiagnostics()">
    <span id="diagToggleText">‚ñ≤ Show Diagnostics</span>
  </button>

  <script type="module" src="js/main.js"></script>
</body>
</html>
