<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voygent - AI-Powered Travel Planning</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f8f9fa;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px 20px;
      text-align: center;
      margin-bottom: 30px;
    }
    h1 { font-size: 2.5rem; margin-bottom: 10px; }
    .subtitle { opacity: 0.9; font-size: 1.1rem; }

    .quick-tuner {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .quick-tuner h2 { margin-bottom: 20px; color: #667eea; }
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
    }
    .form-group {
      display: flex;
      flex-direction: column;
    }
    label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #555;
    }
    input, select, textarea {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
      font-family: inherit;
    }
    textarea { min-height: 100px; resize: vertical; }

    .upload-section {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .upload-section h2 { margin-bottom: 20px; color: #764ba2; }
    .upload-area {
      border: 2px dashed #ccc;
      border-radius: 8px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }
    .upload-area:hover { border-color: #667eea; background: #f0f4ff; }
    .upload-area.dragover { border-color: #764ba2; background: #f5e6ff; }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 32px;
      font-size: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.2s;
    }
    button:hover { transform: translateY(-2px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    @media (max-width: 768px) {
      .options-grid {
        grid-template-columns: 1fr;
      }
    }
    .option-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: all 0.3s;
      border: 3px solid transparent;
    }
    .option-card:hover { transform: translateY(-4px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    .option-card.selected { border-color: #667eea; }
    .option-card h3 { color: #667eea; margin-bottom: 10px; font-size: 1.2rem; }
    .option-card .why {
      color: #666;
      font-style: italic;
      margin-bottom: 15px;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
    }
    .option-card .days { font-size: 0.9rem; color: #777; }

    .variants-section {
      margin-top: 30px;
    }
    .variant-card {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .variant-card h3 { color: #764ba2; margin-bottom: 15px; }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
      font-size: 1.2rem;
    }
    .error {
      background: #fee;
      border: 1px solid #fcc;
      padding: 15px;
      border-radius: 8px;
      color: #c33;
      margin: 20px 0;
    }
    .success {
      background: #efe;
      border: 1px solid #cfc;
      padding: 15px;
      border-radius: 8px;
      color: #363;
      margin: 20px 0;
    }

    .hidden { display: none !important; }

    /* Chat Interface */
    .chat-section {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 30px;
      max-height: 500px;
      display: flex;
      flex-direction: column;
    }
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 15px;
      padding: 10px;
      border: 1px solid #eee;
      border-radius: 8px;
    }
    .chat-message {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 8px;
      max-width: 80%;
    }
    .chat-message.user {
      background: #667eea;
      color: white;
      margin-left: auto;
    }
    .chat-message.assistant {
      background: #f0f0f0;
      color: #333;
    }
    .chat-input-area {
      display: flex;
      gap: 10px;
    }
    .chat-input-area input {
      flex: 1;
    }
    .chat-input-area button {
      padding: 10px 20px;
    }

    /* Diagnostics */
    .diagnostics {
      background: #1a1a1a;
      color: #0f0;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      max-height: 400px;
      overflow-y: auto;
    }
    .diagnostics h3 {
      color: #0f0;
      margin-bottom: 10px;
    }
    .diagnostics .log-entry {
      margin-bottom: 10px;
      padding: 8px;
      background: #2a2a2a;
      border-radius: 4px;
    }
    .diagnostics .timestamp {
      color: #888;
      font-size: 0.8rem;
    }
    .diagnostics .provider {
      color: #4a9eff;
    }
    .diagnostics .tokens {
      color: #ffa500;
    }
    .diagnostics .cost {
      color: #ff4444;
    }
    .toggle-diagnostics {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #1a1a1a;
      color: #0f0;
      border: 2px solid #0f0;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-family: 'Courier New', monospace;
      z-index: 1000;
    }
    .toggle-diagnostics:hover {
      background: #0f0;
      color: #1a1a1a;
    }

    .variant-card button {
      margin-top: 15px;
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    /* Collapsible form styles */
    .form-collapsible-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    .form-collapsible-header h2 {
      margin-bottom: 0;
    }
    .collapse-toggle {
      font-size: 1.5rem;
      transition: transform 0.3s ease;
    }
    .collapse-toggle.collapsed {
      transform: rotate(-90deg);
    }
    .form-content {
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.4s ease, opacity 0.3s ease;
      opacity: 1;
    }
    .form-content.collapsed {
      max-height: 0;
      opacity: 0;
    }

    /* Progress steps */
    .progress-step {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      margin: 10px 0;
      background: white;
      border-radius: 8px;
      border-left: 4px solid #667eea;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      animation: slideIn 0.3s ease;
    }
    .progress-step .step-icon {
      font-size: 1.5rem;
    }
    .progress-step .step-text {
      font-size: 1.1rem;
      color: #333;
      font-weight: 500;
    }
    .progress-step.completed {
      border-left-color: #10b981;
      background: linear-gradient(90deg, #f0fdf4 0%, white 100%);
    }
    .progress-step.completed .step-icon::after {
      content: ' ✓';
      color: #10b981;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Progress Overlay Styles */
    .progress-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .progress-modal {
      background: white;
      padding: 40px;
      border-radius: 16px;
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    .progress-message {
      font-size: 1.1rem;
      color: #333;
      margin-bottom: 20px;
    }
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: width 0.3s ease;
    }

    /* Modal Styles */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-backdrop {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
    }
    .modal-content {
      position: relative;
      background: white;
      padding: 40px;
      border-radius: 16px;
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 1;
    }
    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: transparent;
      border: none;
      font-size: 2rem;
      line-height: 1;
      color: #999;
      cursor: pointer;
      padding: 5px 10px;
    }
    .modal-close:hover {
      color: #333;
      transform: none;
    }
    @media (max-width: 768px) {
      .modal-content {
        padding: 30px 20px;
        width: 95%;
      }
    }

    /* CSS Variables for Branding */
    :root {
      --primary-color: #667eea;
      --accent-color: #764ba2;
    }

    /* Compact Theme Selector Styles */
    .theme-selector-compact {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      max-width: 900px;
      margin: 0 auto 20px;
    }
    .theme-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 15px 20px;
      background: white;
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 120px;
    }
    .theme-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .theme-btn.active {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    }
    .theme-btn .icon {
      font-size: 2.5rem;
    }
    .theme-btn .label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #667eea;
      text-align: center;
    }
    @media (max-width: 600px) {
      .theme-selector-compact {
        flex-direction: column;
        align-items: stretch;
      }
      .theme-btn {
        flex-direction: row;
        justify-content: flex-start;
        padding: 12px 15px;
      }
      .theme-btn .icon {
        font-size: 2rem;
      }
    }

    /* Quick Search Styles */
    .quick-search-section {
      max-width: 600px;
      margin: 0 auto;
    }
    .quick-search-input {
      width: 100%;
      padding: 14px;
      font-size: 1.1rem;
      border: 2px solid var(--accent-color);
      border-radius: 8px;
      margin-bottom: 15px;
    }
    .or-divider {
      position: relative;
      text-align: center;
      margin: 30px 0;
    }
    .or-divider::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background: #ddd;
    }
    .or-divider span {
      position: relative;
      background: #f8f9fa;
      padding: 0 15px;
      color: #999;
      font-weight: 600;
      font-size: 0.9rem;
    }

    /* Collapsible Details Styles */
    details {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary-color);
      list-style: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    details summary::-webkit-details-marker {
      display: none;
    }
    details summary::before {
      content: '▶';
      transition: transform 0.3s;
      display: inline-block;
    }
    details[open] summary::before {
      transform: rotate(90deg);
    }
    details[open] {
      background: #f8f9fa;
    }

    /* Generate Button Styles */
    .generate-btn {
      width: 100%;
      max-width: 600px;
      margin: 30px auto;
      display: block;
      font-size: 1.2rem;
      padding: 16px 32px;
    }

    /* Trip Option Cards */
    #optionsGrid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      margin: 30px 0;
    }

    .trip-option-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .trip-option-card:hover {
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.2);
      transform: translateY(-2px);
    }

    .trip-option-card.selected {
      border-color: #667eea;
      background: linear-gradient(to bottom, #ffffff 0%, #f0f3ff 100%);
    }

    .trip-option-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .trip-option-key {
      background: #667eea;
      color: white;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
    }

    .trip-option-title {
      color: #333;
      font-size: 1.3rem;
      margin: 0;
      flex: 1;
    }

    .trip-option-body {
      margin-bottom: 20px;
    }

    .duration-badge {
      display: inline-block;
      background: #e8eeff;
      color: #667eea;
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .trip-option-cities {
      color: #666;
      margin: 12px 0;
      font-size: 0.95rem;
    }

    .trip-option-description {
      color: #555;
      line-height: 1.6;
      margin: 12px 0;
    }

    .trip-option-budget {
      color: #333;
      font-size: 1.1rem;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #e0e0e0;
    }

    .trip-option-footer {
      text-align: center;
    }

    .select-trip-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease;
      width: 100%;
    }

    .select-trip-btn:hover {
      background: #5568d3;
    }

    .trip-option-card.selected .select-trip-btn {
      background: #4CAF50;
    }

    .trip-option-card.selected .select-trip-btn:hover {
      background: #45a049;
    }

    /* Itinerary Display */
    .itinerary-header {
      text-align: center;
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 2px solid #667eea;
    }

    .itinerary-header h2 {
      color: #667eea;
      font-size: 2rem;
      margin-bottom: 12px;
    }

    .itinerary-overview {
      color: #666;
      font-size: 1.1rem;
      line-height: 1.6;
    }

    .city-section {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .city-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid #f0f0f0;
    }

    .city-header h3 {
      color: #333;
      font-size: 1.5rem;
      margin: 0;
    }

    .nights-badge {
      background: #e8eeff;
      color: #667eea;
      padding: 6px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .city-days {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .day-card {
      display: flex;
      gap: 20px;
      padding: 16px;
      border-left: 4px solid #667eea;
      background: #f9fafb;
      border-radius: 8px;
    }

    .day-number {
      background: #667eea;
      color: white;
      min-width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.95rem;
      flex-shrink: 0;
    }

    .day-content {
      flex: 1;
    }

    .day-activity {
      margin-bottom: 10px;
      color: #333;
      line-height: 1.6;
    }

    .day-why {
      color: #666;
      font-style: italic;
      margin-top: 12px;
      padding-left: 12px;
      border-left: 2px solid #e0e0e0;
    }

    .travel-info {
      margin-top: 10px;
      padding: 8px 12px;
      background: #fff9e6;
      border-radius: 6px;
      color: #856404;
      font-size: 0.9rem;
    }

    /* Cost Breakdown */
    .cost-breakdown {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin: 32px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .cost-breakdown h3 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.5rem;
    }

    .cost-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .cost-table tr {
      border-bottom: 1px solid #e0e0e0;
    }

    .cost-table td {
      padding: 12px 8px;
    }

    .cost-amount {
      text-align: right;
      font-weight: 600;
      color: #333;
      white-space: nowrap;
    }

    .cost-notes {
      color: #666;
      font-size: 0.9rem;
    }

    .cost-total td {
      padding-top: 16px;
      border-top: 2px solid #667eea;
      font-size: 1.1rem;
    }

    .cost-notes-detail {
      color: #666;
      line-height: 1.6;
      margin: 16px 0;
    }

    .cost-assumptions {
      background: #f9fafb;
      padding: 16px;
      border-radius: 8px;
      margin: 16px 0;
    }

    .cost-assumptions ul {
      margin-top: 8px;
      margin-left: 20px;
      color: #666;
    }

    .cost-disclaimer {
      color: #666;
      font-size: 0.95rem;
      font-style: italic;
      margin-top: 20px;
      padding: 12px;
      background: #f0f3ff;
      border-radius: 6px;
      border-left: 4px solid #667eea;
    }

    /* Quote Request Button */
    .itinerary-footer {
      text-align: center;
      margin-top: 32px;
    }

    .request-quote-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px 48px;
      border-radius: 8px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .request-quote-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    }

    /* Responsive Design for Trip Options */
    @media (max-width: 768px) {
      #optionsGrid {
        grid-template-columns: 1fr;
      }

      .city-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .day-card {
        flex-direction: column;
        gap: 12px;
      }

      .day-number {
        width: 50px;
        height: 50px;
        font-size: 0.85rem;
      }

      .cost-table td:last-child {
        display: block;
        padding-left: 8px;
        padding-top: 4px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>🌍 Voygent</h1>
    <p class="subtitle">AI-Powered Travel Planning for Your Perfect Journey</p>
  </header>

  <div class="container">
    <!-- Compact Theme Selector -->
    <div class="quick-tuner" style="padding: 25px 20px;">
      <h2 style="font-size: 1.5rem; margin-bottom: 20px; text-align: center;">Choose Your Trip Theme</h2>
      <div id="themeLoading" style="text-align: center; padding: 20px; color: #666;">
        <div style="display: inline-block; width: 20px; height: 20px; border: 3px solid #667eea; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <span style="margin-left: 10px;">Loading templates...</span>
      </div>

      <!-- Primary/Featured Templates -->
      <div id="primaryThemesContainer" class="theme-selector-compact" style="display: none;">
        <!-- Featured theme buttons will be dynamically inserted here -->
      </div>

      <!-- Secondary Templates (Searchable) -->
      <div id="secondaryThemesContainer" style="display: none; margin-top: 20px;">
        <details style="background: #f8f9fa; border-radius: 8px; padding: 15px; border: 1px solid #e0e0e0;">
          <summary style="cursor: pointer; font-weight: 600; color: #667eea; display: flex; align-items: center; gap: 8px;">
            <span>✨</span>
            <span>More Specialized Themes</span>
            <span id="secondaryThemeCount" style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.85em;"></span>
          </summary>

          <div style="margin-top: 15px;">
            <input
              type="text"
              id="themeSearchInput"
              placeholder="🔍 Search for a theme (e.g., wellness, music, wine)..."
              style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; margin-bottom: 15px;"
            />

            <div id="secondaryThemesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; max-height: 300px; overflow-y: auto;">
              <!-- Secondary theme buttons will be dynamically inserted here -->
            </div>

            <div id="noThemesFound" style="display: none; text-align: center; padding: 20px; color: #999;">
              No themes match your search
            </div>
          </div>
        </details>
      </div>

      <input type="hidden" id="selectedTheme" value="heritage">
    </div>

    <!-- Unified Quick Search Section -->
    <div class="quick-tuner" style="padding: 30px;">
      <div class="quick-search-section">
        <h2 id="themeTitle" style="font-size: 1.8rem; margin-bottom: 10px; text-align: center; color: var(--primary-color);">Heritage & Ancestry Trip</h2>
        <p id="themeSubtitle" style="text-align: center; color: #666; margin-bottom: 20px;">Explore your family roots and ancestral heritage</p>

        <input
          type="text"
          id="quickSearch"
          class="quick-search-input"
          placeholder="Enter family surname (e.g., McLeod)"
          data-heritage-placeholder="Enter family surname (e.g., McLeod)"
          data-tvmovie-placeholder="Enter show/movie name (e.g., Game of Thrones)"
          data-historical-placeholder="Enter historical event (e.g., D-Day Normandy)"
          data-culinary-placeholder="Enter cuisine or region (e.g., Tuscany pasta)"
          data-adventure-placeholder="Enter activity (e.g., Patagonia hiking)"
        />

        <div class="or-divider">
          <span>OR</span>
        </div>

        <!-- Collapsible Customize Section -->
        <details id="customizeDetails">
          <summary>📝 Customize Your Trip</summary>
          <form id="quickTunerForm" style="margin-top: 20px;">
        <div class="form-grid">
          <div class="form-group" id="themeSpecificField1">
            <label for="surnames" id="field1Label">Family Surnames *</label>
            <input type="text" id="surnames" placeholder="e.g., McLeod, Roberts">
          </div>
          <div class="form-group" id="themeSpecificField2">
            <label for="origins" id="field2Label">Suspected Origins</label>
            <input type="text" id="origins" placeholder="Unknown - AI will guess from surname">
          </div>
          <div class="form-group">
            <label for="adults">Adults</label>
            <input type="number" id="adults" min="1" value="2" required>
          </div>
          <div class="form-group">
            <label for="children">Children (ages)</label>
            <input type="text" id="children" placeholder="e.g., 12, 15">
          </div>
          <div class="form-group">
            <label for="duration">Duration (days)</label>
            <input type="number" id="duration" min="1" max="30" value="7">
          </div>
          <div class="form-group">
            <label for="month">Target Month</label>
            <select id="month">
              <option value="">Any</option>
              <option value="January">January</option>
              <option value="February">February</option>
              <option value="March">March</option>
              <option value="April">April</option>
              <option value="May">May</option>
              <option value="June">June</option>
              <option value="July">July</option>
              <option value="August">August</option>
              <option value="September">September</option>
              <option value="October">October</option>
              <option value="November">November</option>
              <option value="December">December</option>
            </select>
          </div>
          <div class="form-group">
            <label for="luxury">Luxury Level</label>
            <select id="luxury">
              <option value="Savvy">Savvy</option>
              <option value="Comfort" selected>Comfort</option>
              <option value="Boutique">Boutique</option>
              <option value="OccasionalLuxe">Occasional Luxe</option>
            </select>
          </div>
          <div class="form-group">
            <label for="activity">Activity Level</label>
            <select id="activity">
              <option value="gentle">Gentle</option>
              <option value="moderate" selected>Moderate</option>
              <option value="ambitious">Ambitious</option>
            </select>
          </div>
          <div class="form-group">
            <label for="travel_pace">Travel Pace</label>
            <select id="travel_pace">
              <option value="relaxed">Relaxed (2-3 days per city)</option>
              <option value="moderate" selected>Moderate (2 cities per 10 days)</option>
              <option value="exploratory">Exploratory (3-4 cities per 10 days)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="airport">Departure Airport</label>
            <input type="text" id="airport" placeholder="e.g., LAX, JFK, ORD">
          </div>
          <div class="form-group">
            <label for="transport_pref">Transport Preference</label>
            <select id="transport_pref">
              <option value="train">Train preferred</option>
              <option value="car">Car rental preferred</option>
              <option value="mixed" selected>Mix of train & car</option>
              <option value="driver">Driver/guide preferred</option>
            </select>
          </div>
          <div class="form-group">
            <label for="hotel_type">Hotel Type</label>
            <select id="hotel_type">
              <option value="budget">Budget ($80-120/night)</option>
              <option value="midrange" selected>Mid-range ($120-200/night)</option>
              <option value="upscale">Upscale ($200-350/night)</option>
              <option value="luxury">Luxury ($350+/night)</option>
            </select>
          </div>
        </div>
        <div class="form-group" style="margin-top: 20px;">
          <label for="notes">Additional Notes / Genealogy Links</label>
          <textarea id="notes" placeholder="Paste genealogy URLs, add context about your family history..."></textarea>
        </div>
      </form>

      <!-- Upload Section -->
      <div class="upload-section" id="uploadSection" style="margin-top: 30px;">
        <h3 style="margin-bottom: 15px;">📎 Upload Documents</h3>
        <div class="upload-area" id="uploadArea">
          <p>📁 Drop files here or click to upload</p>
          <p style="font-size: 0.9rem; color: #999; margin-top: 10px;">
            PDFs, images (OCR supported), or text documents
          </p>
          <input type="file" id="fileInput" multiple accept="image/*,.pdf,.txt" style="display:none;">
        </div>
        <div id="fileList" style="margin-top: 15px;"></div>
      </div>
    </details>
  </div>

    <button id="generateBtn" onclick="generateTrip()">✨ Generate Trip Options</button>

    <div id="loading" class="loading hidden">
      <div style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 3rem; animation: spin 2s linear infinite; display: inline-block;">🔄</div>
      </div>
      <div id="progressSteps" style="max-width: 600px; margin: 0 auto;">
        <div class="progress-step" id="step1">
          <span class="step-icon">⏳</span>
          <span class="step-text">Analyzing your input...</span>
        </div>
        <div class="progress-step hidden" id="step2">
          <span class="step-icon">🔍</span>
          <span class="step-text">Researching surname origins...</span>
        </div>
        <div class="progress-step hidden" id="step3">
          <span class="step-icon">🧠</span>
          <span class="step-text">AI analyzing heritage connections...</span>
        </div>
        <div class="progress-step hidden" id="step4">
          <span class="step-icon">✈️</span>
          <span class="step-text">Generating personalized trip options...</span>
        </div>
      </div>

      <!-- Detailed progress log -->
      <details open style="max-width: 800px; margin: 30px auto 0; background: white; padding: 20px; border-radius: 8px;">
        <summary style="cursor: pointer; font-weight: 600; color: #667eea; margin-bottom: 15px;">📋 Detailed Progress Log</summary>
        <div id="progressLog" style="font-family: 'Courier New', monospace; font-size: 0.85rem; max-height: 300px; overflow-y: auto; background: #1a1a1a; color: #0f0; padding: 15px; border-radius: 4px;">
          <div class="log-line">⏳ Initializing...</div>
        </div>
      </details>
    </div>

    <div id="error" class="error hidden"></div>
    <div id="success" class="success hidden"></div>

    <!-- AI Research Summary -->
    <div id="researchSummary" class="hidden" style="background: linear-gradient(135deg, #e8f4f8 0%, #f0e8ff 100%); padding: 30px; border-radius: 12px; margin: 30px 0; border-left: 5px solid #667eea;">
      <h2 style="color: #667eea; margin-bottom: 15px;">🔍 What We Discovered About Your Heritage</h2>
      <div id="researchContent" style="font-size: 1.05rem; line-height: 1.8; color: #333;"></div>
      <details style="margin-top: 20px;">
        <summary style="cursor: pointer; color: #667eea; font-weight: 600;">📚 View Research Sources</summary>
        <div id="researchSources" style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.6); border-radius: 8px;"></div>
      </details>
    </div>

    <!-- Options Grid -->
    <div id="optionsSection" class="hidden">
      <h2 style="margin-top: 40px; margin-bottom: 20px;">Choose Your Journey</h2>
      <div id="optionsGrid" class="options-grid"></div>
      <button id="confirmBtn" class="hidden" onclick="confirmSelection()" style="margin-top: 20px;">
        Continue to Detailed Itineraries
      </button>
    </div>

    <!-- Trip Styles -->
    <div id="variantsSection" class="variants-section hidden">
      <h2>Choose Your Trip Style</h2>
      <p style="color: #666; margin-bottom: 20px;">We've created two different styles for your trip. Review both and select your preference.</p>
      <div id="variantsContainer"></div>
    </div>

    <!-- Chat Interface -->
    <div id="chatSection" class="chat-section hidden">
      <h3>💬 Chat with Voygent</h3>
      <div id="chatMessages" class="chat-messages"></div>
      <div class="chat-input-area">
        <input type="text" id="chatInput" placeholder="Ask about your trip, make changes..." />
        <button onclick="sendChatMessage()">Send</button>
      </div>
    </div>

    <!-- Diagnostics -->
    <div id="diagnostics" class="diagnostics hidden">
      <h3>🔧 Developer Diagnostics</h3>
      <div id="diagnosticsLog"></div>
    </div>
  </div>

  <button class="toggle-diagnostics" onclick="toggleDiagnostics()">
    <span id="diagToggleText">▲ Show Diagnostics</span>
  </button>

  <!-- Progress Overlay -->
  <div id="progressOverlay" class="progress-overlay hidden">
    <div class="progress-modal">
      <div class="spinner"></div>
      <p id="progressMessage" class="progress-message">Understanding your preferences...</p>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
      </div>
    </div>
  </div>

  <!-- Traveler Intake Modal -->
  <div id="travelerIntakeModal" class="modal hidden">
    <div class="modal-backdrop" onclick="closeTravelerIntake()"></div>
    <div class="modal-content">
      <button class="modal-close" onclick="closeTravelerIntake()">×</button>

      <h2>Complete Your Quote Request</h2>
      <p style="color: #666; margin-bottom: 25px;">Help us connect you with the perfect travel professional</p>

      <form id="travelerIntakeForm">
        <!-- Required fields -->
        <div class="form-group">
          <label>Primary Traveler Name <span class="required" style="color: #c33;">*</span></label>
          <input type="text" name="primary_name" required />
        </div>

        <div class="form-group">
          <label>Email <span class="required" style="color: #c33;">*</span></label>
          <input type="email" name="email" required />
        </div>

        <div class="form-group">
          <label>Phone Number</label>
          <input type="tel" name="phone" placeholder="(555) 123-4567" />
        </div>

        <!-- Optional fields (collapsible) -->
        <details style="margin-top: 20px;">
          <summary style="cursor: pointer; font-weight: 600; color: #667eea; margin-bottom: 15px;">Additional Traveler Details (Optional)</summary>

          <div class="form-group">
            <label>All Travelers (names and ages)</label>
            <textarea name="travelers" rows="3" placeholder="e.g., John Smith (45), Jane Smith (42), Emily Smith (12)"></textarea>
          </div>

          <div class="form-group">
            <label>Passport Status</label>
            <select name="passport_status">
              <option value="">Select...</option>
              <option value="all_valid">All travelers have valid passports</option>
              <option value="some_expired">Some passports expired or expiring soon</option>
              <option value="none">No passports yet</option>
            </select>
          </div>

          <div class="form-group">
            <label>Dietary or Medical Restrictions</label>
            <textarea name="restrictions" rows="2" placeholder="e.g., vegetarian, gluten-free, wheelchair accessible"></textarea>
          </div>

          <div class="form-group">
            <label>Airline Loyalty Programs</label>
            <input type="text" name="airline_loyalty" placeholder="e.g., Delta SkyMiles #123456" />
          </div>

          <div class="form-group">
            <label>Hotel Loyalty Programs</label>
            <input type="text" name="hotel_loyalty" placeholder="e.g., Marriott Bonvoy #987654" />
          </div>

          <div class="form-group">
            <label>Preferred Contact Method</label>
            <select name="contact_method">
              <option value="email">Email</option>
              <option value="phone">Phone</option>
              <option value="either">Either</option>
            </select>
          </div>
        </details>

        <button type="submit" class="primary-action" style="margin-top: 25px; width: 100%;">
          Submit Quote Request
        </button>
      </form>

      <div id="submissionConfirmation" class="hidden" style="text-align: center; padding: 40px 20px;">
        <div style="font-size: 4rem; margin-bottom: 20px;">✅</div>
        <h3 style="color: #667eea; margin-bottom: 15px;">Quote Request Submitted!</h3>
        <p style="color: #666; margin-bottom: 25px;">A travel professional will contact you within 24 hours.</p>
        <button onclick="closeTravelerIntake()" class="primary-action">Close</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
